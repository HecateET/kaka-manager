<template>
  <div>
    <div>
      <el-breadcrumb separator-class="el-icon-arrow-right" class="bread">
        <el-breadcrumb-item :to="{ path: '/control' }"><i class="el-icon-upload"></i>&nbsp;æ§åˆ¶å°</el-breadcrumb-item>
        <el-breadcrumb-item>å†…å®¹ç®¡ç†</el-breadcrumb-item>
        <el-breadcrumb-item>æ´»åŠ¨å‘å¸ƒ</el-breadcrumb-item>
      </el-breadcrumb>
    </div>
    <hr>
    <div style="margin: 10px">å…¬å‘Šç±»æ´»åŠ¨å‘å¸ƒ</div>
    <div class="form-box">
      <el-form ref="form" :model="activityEdit" label-width="80px" size="mini">
        <el-form-item label="æ–‡ç« åç§°">
          <el-input v-model="activityEdit.title"></el-input>
        </el-form-item>
        <el-form-item label="æ–‡ç« ç±»å‹">
          <el-select v-model="activityEdit.type" placeholder="è¯·é€‰æ‹©å‘å¸ƒæ´»åŠ¨çš„ç±»å‹">
            <el-option label="å…¬å‘Šç±»" value="å…¬å‘Š"></el-option>
          </el-select>
        </el-form-item>
        <el-form-item label="å‘å¸ƒæ—¶é—´">
          <el-col :span="11">
            <el-date-picker type="datetime" placeholder="é€‰æ‹©æ—¥æœŸ" v-model="activityEdit.date" style="width: 100%;"></el-date-picker>
          </el-col>
        </el-form-item>
      </el-form>
    </div>
     <div>
      <div ref="editor" style=" width: 700px;text-align:left"></div>
    </div>
    <hr>
    <el-row>
        <el-button v-on:click="publish()" type="primary">å‘å¸ƒ</el-button>
        <el-button v-on:click="cancelPublish()" type="danger">å–æ¶ˆ</el-button>
    </el-row>

  </div>
</template>

<script>

  import E from  'wangeditor'
  export default {
        name: "ManagerEdit",
      data(){
        return {
          editorContent:'',
          activityEdit: {
            title: '',
            type: 'å…¬å‘Š',
            date: '',
          },
        };
      },
    methods: {
      //åˆ›å»ºå¯Œæ–‡æœ¬ç¼–è¾‘å™¨
      createEdioter(){
        var editor = new E(this.$refs.editor);
        editor.customConfig.onchange = (html)=>{
          this.editorContent = html;
        };
        editor.customConfig.colors = [
          '#000000',
          '#eeece0',
          '#1c487f',
          '#4d80bf',
          '#c24f4a',
          '#8baa4a',
          '#7b5ba1',
          '#46acc8',
          '#f9963b',
          '#ffffff',
          '#DB70DB',
          '#cc1d18'
        ];
        // è¡¨æƒ…é¢æ¿å¯ä»¥æœ‰å¤šä¸ª tab ï¼Œå› æ­¤è¦é…ç½®æˆä¸€ä¸ªæ•°ç»„ã€‚æ•°ç»„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ª tab çš„é…ç½®
        editor.customConfig.emotions = [
          {
            // tab çš„æ ‡é¢˜
            title: 'é»˜è®¤',
            // type -> 'emoji' / 'image'
            type: 'image',
            // content -> æ•°ç»„
            content: [
              {
                alt:'[åƒç“œ]',
                src:'http://localhost:3000/eoim/1.png'
              },
              {
                alt:'[å“­ç¬‘]',
                src:'http://localhost:3000/eoim/2.png'
              },
              {
                alt:'[åç¬‘]',
                src:'http://localhost:3000/eoim/3.png'
              },
              {
                alt:'[è‹¦ç¬‘]',
                src:'http://localhost:3000/eoim/4.png'
              },
              {
                alt:'[å˜´é¦‹]',
                src:'http://localhost:3000/eoim/5.png'
              },
              {
                alt:'[ä½ å¥½]',
                src:'http://localhost:3000/eoim/6.png'
              },
              {
                alt:'[å³å“¼å“¼]',
                src:'http://localhost:3000/eoim/7.png'
              },
              {
                alt:'[å·¦å“¼å“¼]',
                src:'http://localhost:3000/eoim/8.png'
              },
              {
                alt:'[åƒç“œ]',
                src:'http://localhost:3000/eoim/9.png'
              },
              {
                alt:'[å¤§éª‚]',
                src:'http://localhost:3000/eoim/10.png'
              },
              {
                alt:'[å¾®ç¬‘]',
                src:'http://localhost:3000/eoim/11.png'
              },
              {
                alt:'[è‰²]',
                src:'http://localhost:3000/eoim/12.png'
              },
              {
                alt:'[äº²äº²]',
                src:'http://localhost:3000/eoim/13.png'
              },
              {
                alt:'[å–èŒ]',
                src:'http://localhost:3000/eoim/14.png'
              },
              {
                alt:'[è°ƒçš®]',
                src:'http://localhost:3000/eoim/15.png'
              },
              {
                alt:'[å€’éœ‰]',
                src:'http://localhost:3000/eoim/16.png'
              },
              {
                alt:'[ç”Ÿç—…]',
                src:'http://localhost:3000/eoim/17.png'
              },
              {
                alt:'[åƒç“œ]',
                src:'http://localhost:3000/eoim/18.png'
              },
              {
                alt:'[å¯æ€œ]',
                src:'http://localhost:3000/eoim/19.png'
              },
              {
                alt:'[æ±—]',
                src:'http://localhost:3000/eoim/20.png'
              },
              {
                alt:'[è‰²è‰²]',
                src:'http://localhost:3000/eoim/21.png'
              },
              {
                alt:'[å“ˆå“ˆ]',
                src:'http://localhost:3000/eoim/22.png'
              },
              {
                alt:'[é’±]',
                src:'http://localhost:3000/eoim/23.png'
              },
              {
                alt:'[æ€è€ƒ]',
                src:'http://localhost:3000/eoim/24.png'
              },
              {
                alt:'[ç”Ÿç—…]',
                src:'http://localhost:3000/eoim/25.png'
              },
              {
                alt:'[å›°]',
                src:'http://localhost:3000/eoim/26.png'
              },
              {
                alt:'[äº’ç²‰]',
                src:'http://localhost:3000/eoim/27.png'
              },
              {
                alt:'[çŒç¡]',
                src:'http://localhost:3000/eoim/28.png'
              },
              {
                alt:'[æœºæ™º]',
                src:'http://localhost:3000/eoim/29.png'
              },
              {
                alt:'[å®³ç¾]',
                src:'http://localhost:3000/eoim/30.png'
              },
              {
                alt:'[é¼»å­”]',
                src:'http://localhost:3000/eoim/31.png'
              },
              {
                alt:'[ç–‘æƒ‘]',
                src:'http://localhost:3000/eoim/32.png'
              },
              {
                alt:'[å¤§å“­]',
                src:'http://localhost:3000/eoim/33.png'
              },
              {
                alt:'[æ‰“ä½ ]',
                src:'http://localhost:3000/eoim/34.png'
              },
              {
                alt:'[æŒ£æ‰]',
                src:'http://localhost:3000/eoim/35.png'
              },
              {
                alt:'[å¤§ç¬‘]',
                src:'http://localhost:3000/eoim/36.png'
              },
              {
                alt:'[åƒæƒŠ]',
                src:'http://localhost:3000/eoim/37.png'
              },
              {
                alt:'[æ™•ä¹]',
                src:'http://localhost:3000/eoim/38.png'
              },
              {
                alt:'[é„™è§†]',
                src:'http://localhost:3000/eoim/39.png'
              },
              {
                alt:'[å«Œå¼ƒ]',
                src:'http://localhost:3000/eoim/40.png'
              },
              {
                alt:'[å“ˆæ¬ ]',
                src:'http://localhost:3000/eoim/41.png'
              },
              {
                alt:'[å“­]',
                src:'http://localhost:3000/eoim/42.png'
              },
              {
                alt:'[ç”Ÿæ°”]',
                src:'http://localhost:3000/eoim/43.png'
              },
            ]
          },
          {
            // tab çš„æ ‡é¢˜
            title: 'emoji',
            // type -> 'emoji' / 'image'
            type: 'emoji',
            // content -> æ•°ç»„
            content: ['ğŸ˜€', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜', 'ğŸ˜†','ğŸ˜€','ğŸ˜','ğŸ˜‚','ğŸ˜ƒ','ğŸ˜„','ğŸ˜…','ğŸ˜†','ğŸ˜‰','ğŸ˜Š','ğŸ˜‹','ğŸ˜','ğŸ˜','ğŸ˜˜','ğŸ˜—','ğŸ˜™','ğŸ˜š',
            'â˜º','ğŸ˜‡','ğŸ˜','ğŸ˜‘','ğŸ˜¶','ğŸ˜','ğŸ˜£','ğŸ˜¥','ğŸ˜®','ğŸ˜¯','ğŸ˜ª','ğŸ˜«','ğŸ˜´','ğŸ˜Œ','ğŸ˜›','ğŸ˜œ','ğŸ˜','ğŸ˜’','ğŸ˜“','ğŸ˜”','ğŸ˜•','ğŸ˜²',
            'ğŸ˜·','ğŸ˜–','ğŸ˜','ğŸ˜Ÿ','ğŸ˜¤','ğŸ˜¢','ğŸ˜­','ğŸ˜¦','ğŸ˜§','ğŸ˜¨','ğŸ˜¬','ğŸ˜°','ğŸ˜±','ğŸ˜³','ğŸ˜µ','ğŸ˜¡','ğŸ˜ ']
          }
        ];
        editor.customConfig.menus = [
          'head',  // æ ‡é¢˜
          'bold',  // ç²—ä½“
          'fontSize',  // å­—å·
          'fontName',  // å­—ä½“
          'italic',  // æ–œä½“
          'underline',  // ä¸‹åˆ’çº¿
          'strikeThrough',  // åˆ é™¤çº¿
          'foreColor',  // æ–‡å­—é¢œè‰²
          'backColor',  // èƒŒæ™¯é¢œè‰²
          'link',  // æ’å…¥é“¾æ¥
          'list',  // åˆ—è¡¨
          'justify',  // å¯¹é½æ–¹å¼
          'quote',  // å¼•ç”¨
          'emoticon',  // è¡¨æƒ…
          'table',  // è¡¨æ ¼
          'undo',  // æ’¤é”€
          'redo'  // é‡å¤
        ];
        //é…ç½®æœåŠ¡å™¨ç«¯åœ°å€
        //editor.customConfig.uploadImgServer = 'http://localhost:3000/activityEdit';
        editor.create();
      },
      //æ—¶é—´æ ¼å¼è½¬æ¢
      changeTime(d){
            let date = `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()} ${d.getHours()}:${d.getMinutes()}:${d.getSeconds()}`
            return date;
          },
      //å–æ¶ˆå‘å¸ƒ
      cancelPublish(){

      },
      //å‘å¸ƒæ–‡ç« 
      publish:function(){
        var _this = this;
        if(this.activityEdit.title==''){
          alert('æ–‡ç« æ ‡é¢˜ä¸èƒ½ä¸ºç©ºï¼');
        }else if(this.activityEdit.type==''){
          alert('æ–‡ç« ç±»å‹æœªé€‰æ‹©ï¼Œè¯·é€‰æ‹©ï¼');
        }else if(this.activityEdit.date==''){
          alert('å‘å¸ƒæ—¶é—´æœªé€‰æ‹©ï¼Œè¯·å¡«å†™ï¼');
        }else if(this.editorContent==''){
          alert('æ–‡ç« å†…å®¹ä¸ºå¡«å†™ï¼Œè¯·è¡¥å……ï¼');
        } else{
          let date = this.changeTime(this.activityEdit.date);
          this.$ajax.post('http://localhost:3000/manager/activityEdit',{
            acName:_this.activityEdit.title,
            acStartDate:date,
            acType:_this.activityEdit.type,
            acDetails:_this.editorContent
          }).then(function (result) {
            alert("æ–‡ç« å‘å¸ƒæˆåŠŸï¼");
            _this.activityEdit.title = '';
            _this.activityEdit.type = 'å…¬å‘Š';
            _this.activityEdit.date = '';
            _this.editorContent = ' ';
            console.log('æ’å…¥æˆåŠŸï¼š'+result.data.data);
          },function (err) {
            console.log(err);
          })
        }

        },
    },
      mounted(){
         this.createEdioter();
      }
    }
</script>

<style scoped>
  .form-box{
    width: 500px;
  }
  .el-picker-panel,.el-date-picker,.el-popper{
    z-index:20000 !important;
  }
</style>
